<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
    <link rel="shortcut icon" href="/" type="image/x-icon" />
    <link rel="preconnect" href="https://fonts.loli.net">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.loli.net/css2?family=Noto+Sans+SC:wght@100..900&display=swap" rel="stylesheet">
    <title>
        
            Windows 虚拟桌面的最佳实践 |
         
        wolfyzhang&#39;s Homepage
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    
<link rel="stylesheet" href="/css/font.css">

     
    
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-P8TPGHN83M"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-P8TPGHN83M');
        </script>
    


 
    
        <script>
            var _hmt = _hmt || [];
            (function() {
              var hm = document.createElement("script");
              hm.src = "https://hm.baidu.com/hm.js?814574df4ca5d3c5a44b815c9ad229ef";
              var s = document.getElementsByTagName("script")[0]; 
              s.parentNode.insertBefore(hm, s);
            })();
        </script>
    

   
<meta name="generator" content="Hexo 7.3.0"></head>

<body>
    <div class="body-container">
        <div class="header-wrapper"><header>
    <div class="header-container">
        <div class="header-menu">
            <div class="header-menu-inside">
                
                    <div class="header-menu-home"><a href="/">Home</a></div>
                
                
                    <div class="header-menu-links"><a href="/links">Links</a></div>
                
                
                    <div class="header-menu-about"><a href="/about">About</a></div>
                
            </div>
        </div>
    </div>
    <hr>
</header>
</div>
        <div class="main-wrapper"><main>
    <div class="main-container">
        <div class="post-details">
            
            
                <div class="post-title">
                    <h1>Windows 虚拟桌面的最佳实践</h1>
                </div>
                <div class="post-meta">
                    <i>Published</i>&nbsp;
                    <span class="post-date">
                        2023/08/14
                    </span>&nbsp;&nbsp;
                    <i>Updated</i>&nbsp;
                    <span class="post-updated">
                        2024/02/27
                    </span>
                </div>
            
            <div class="post-content">
                <p><strong>标题：Windows 虚拟桌面：释放多任务潜能，提升工作效率</strong></p>
<p><strong>引言：</strong><br />
在当今信息爆炸的时代，我们经常需要同时处理多个任务，在繁杂的工作中寻找效率。Windows 虚拟桌面功能犹如一块神奇的幕布，允许你在不同的空间中排列应用窗口，轻松切换不同工作区，提升你的生产力和工作效率。</p>
<p><strong>一、虚拟桌面的基础知识</strong></p>
<ol>
<li>
<p><strong>什么是虚拟桌面？</strong><br />
虚拟桌面是一种软件功能，允许你在计算机上创建和管理多个虚拟桌面。每个虚拟桌面都是一个独立的空间，可以放置不同的应用程序窗口和文件。你可以根据不同的任务或项目需求，创建不同的虚拟桌面，比如一个用于工作、一个用于学习、一个用于娱乐等。</p>
</li>
<li>
<p><strong>如何创建虚拟桌面？</strong><br />
在 Windows 10 和 11 中，你可以通过以下两种方式创建虚拟桌面：</p>
<ul>
<li>按住键盘上的 “Windows 键” + “Tab 键”，然后在任务视图界面中点击 “新建桌面” 按钮。</li>
<li>在任务栏上右键点击 “任务视图” 按钮，然后选择 “新建桌面”。</li>
</ul>
</li>
<li>
<p><strong>如何切换虚拟桌面？</strong><br />
你可以使用以下几种方式在虚拟桌面之间切换：</p>
<ul>
<li>使用键盘上的 “Windows 键” + “Ctrl 键” + “左箭头 / 右箭头” 组合键。</li>
<li>在任务视图界面中点击不同的桌面缩略图。</li>
<li>在任务栏上右键点击 “任务视图” 按钮，然后选择要切换到的桌面。</li>
</ul>
</li>
<li>
<p><strong>如何关闭虚拟桌面？</strong><br />
你可以通过以下两种方式关闭虚拟桌面：</p>
<ul>
<li>在任务视图界面中点击要关闭的桌面的 “关闭” 按钮。</li>
<li>在任务栏上右键点击 “任务视图” 按钮，然后选择 “关闭当前桌面”。</li>
</ul>
</li>
</ol>
<p><strong>二、虚拟桌面的最佳实践</strong></p>
<ol>
<li>
<p><strong>合理分配虚拟桌面</strong><br />
在创建虚拟桌面时，可以根据自己的工作或学习需求，合理分配不同任务的虚拟桌面。比如，你可以将与工作相关的应用程序放在一个虚拟桌面上，将与学习相关的应用程序放在另一个虚拟桌面上，将与娱乐相关的应用程序放在第三个虚拟桌面上。这样，你可以轻松地切换到不同的虚拟桌面，专注于当前的任务。</p>
</li>
<li>
<p><strong>使用虚拟桌面优化工作流程</strong><br />
虚拟桌面可以帮助你优化工作流程，提升效率。例如，你可以将经常使用的应用程序固定在不同的虚拟桌面上，这样你就可以快速地访问它们。你还可以使用虚拟桌面来管理不同的项目，将与每个项目相关的应用程序和文件放在同一个虚拟桌面上，这样你就可以轻松地切换到不同的项目并继续工作。</p>
</li>
<li>
<p><strong>利用虚拟桌面增强隐私保护</strong><br />
虚拟桌面还可以帮助你增强隐私保护。当你使用不同的虚拟桌面时，你可以将不同的应用程序和文件隔离开来，这样即使有人访问你的计算机，他们也无法看到你正在处理的其他任务。这可以保护你的隐私并防止你的信息泄露。</p>
</li>
</ol>
<p><strong>三、代码示例：在 C# 中使用虚拟桌面</strong></p>
<p>以下代码示例演示了如何在 C# 中使用虚拟桌面：</p>
<pre><code class="hljs csharp"><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.Runtime.InteropServices;

<span class="hljs-keyword">namespace</span> <span class="hljs-title">VirtualDesktopDemo</span>
&#123;
    <span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>
    &#123;
        [<span class="hljs-meta">DllImport (<span class="hljs-string">&quot;user32.dll&quot;</span>)</span>]
        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">extern</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">CreateDesktop</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> desktopName, IntPtr desktopHandle, IntPtr reserved, <span class="hljs-built_in">int</span> flags, <span class="hljs-built_in">uint</span> creationAccess, <span class="hljs-keyword">ref</span> SECURITY_ATTRIBUTES securityAttributes</span>)</span>;

        [<span class="hljs-meta">DllImport (<span class="hljs-string">&quot;user32.dll&quot;</span>)</span>]
        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">extern</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">CloseDesktop</span>(<span class="hljs-params">IntPtr desktopHandle</span>)</span>;

        [<span class="hljs-meta">DllImport (<span class="hljs-string">&quot;user32.dll&quot;</span>)</span>]
        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">extern</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">SwitchDesktop</span>(<span class="hljs-params">IntPtr desktopHandle</span>)</span>;

        [<span class="hljs-meta">DllImport (<span class="hljs-string">&quot;user32.dll&quot;</span>)</span>]
        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">extern</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">EnumDesktops</span>(<span class="hljs-params">IntPtr hwinsta, EnumDesktopProc callback, IntPtr lParam</span>)</span>;

        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-built_in">delegate</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">EnumDesktopProc</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> desktopName, IntPtr desktopHandle, IntPtr lParam</span>)</span>;

        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] args</span>)</span>
        &#123;
            <span class="hljs-comment">// 创建一个新的虚拟桌面 </span>
            IntPtr desktopHandle = IntPtr.Zero;
            SECURITY_ATTRIBUTES securityAttributes = <span class="hljs-keyword">new</span> SECURITY_ATTRIBUTES ();
            securityAttributes.nLength = Marshal.SizeOf (securityAttributes);
            securityAttributes.lpSecurityDescriptor = IntPtr.Zero;
            securityAttributes.bInheritHandle = <span class="hljs-literal">true</span>;
            <span class="hljs-built_in">bool</span> result = CreateDesktop (<span class="hljs-string">&quot;MyVirtualDesktop&quot;</span>, desktopHandle, IntPtr.Zero, <span class="hljs-number">0</span>, <span class="hljs-number">0x10000000</span>, <span class="hljs-keyword">ref</span> securityAttributes);
            <span class="hljs-keyword">if</span> (result)
            &#123;
                Console.WriteLine (<span class="hljs-string">&quot;Virtual desktop created successfully.&quot;</span>);
            &#125;
            <span class="hljs-keyword">else</span>
            &#123;
                Console.WriteLine (<span class="hljs-string">&quot;Failed to create virtual desktop.&quot;</span>);
            &#125;

            <span class="hljs-comment">// 切换到新的虚拟桌面 </span>
            result = SwitchDesktop (desktopHandle);
            <span class="hljs-keyword">if</span> (result)
            &#123;
                Console.WriteLine (<span class="hljs-string">&quot;Switched to virtual desktop successfully.&quot;</span>);
            &#125;
            <span class="hljs-keyword">else</span>
            &#123;
                Console.WriteLine (<span class="hljs-string">&quot;Failed to switch to virtual desktop.&quot;</span>);
            &#125;

            <span class="hljs-comment">// 枚举所有虚拟桌面 </span>
            IntPtr hwinsta = GetCurrentWindowStation ();
            EnumDesktops (hwinsta, EnumDesktopCallback, IntPtr.Zero);

            <span class="hljs-comment">// 关闭虚拟桌面 </span>
            result = CloseDesktop (desktopHandle);
            <span class="hljs-keyword">if</span> (result)
            &#123;
                Console.WriteLine (<span class="hljs-string">&quot;Virtual desktop closed successfully.&quot;</span>);
            &#125;
            <span class="hljs-keyword">else</span>
            &#123;
                Console.WriteLine (<span class="hljs-string">&quot;Failed to close virtual desktop.&quot;</span>);
            &#125;
        &#125;

        [<span class="hljs-meta">DllImport (<span class="hljs-string">&quot;user32.dll&quot;</span>)</span>]
        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">extern</span> IntPtr <span class="hljs-title">GetCurrentWindowStation</span>()</span>;

        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">EnumDesktopCallback</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> desktopName, IntPtr desktopHandle, IntPtr lParam</span>)</span>
        &#123;
            Console.WriteLine (<span class="hljs-string">$&quot;Desktop name: <span class="hljs-subst">&#123;desktopName&#125;</span>, Desktop handle: <span class="hljs-subst">&#123;desktopHandle&#125;</span>&quot;</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        &#125;
    &#125;

    [<span class="hljs-meta">StructLayout (LayoutKind.Sequential)</span>]
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">struct</span> SECURITY_ATTRIBUTES
    &#123;
        <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> nLength;
        <span class="hljs-keyword">public</span> IntPtr lpSecurityDescriptor;
        <span class="hljs-keyword">public</span> <span class="hljs-built_in">bool</span> bInheritHandle;
    &#125;
&#125;</code></pre>
<p><strong>结语：</strong><br />
Windows 虚拟桌面功能就像是一个神奇的工具箱，帮助你在繁杂的工作中游刃有余，提升效率。合理分配虚拟桌面，优化工作流程，增强隐私保护，让你在工作和学习中更加得心应手。希望这篇文章对你有帮助，祝你在探索虚拟桌面的世界中收获更多乐趣和效率！</p>

            </div>
        </div>
    </div>
</main>


    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0/dist/katex.min.css">
  

</div>
        <div class="footer-wrapper"><footer>
    <div class="footer-container">
        <div class="footer-meta">
            
                <div class="footer-meta-copyright">
                    Copyright &copy; 2024 wolfyzhang.
                </div>
            
            <div class="footer-meta-symbols-count">
                All words count: 74k.
            </div>
            <!--
            
                <div class="footer-meta-licenese">
                    Licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC-BY-NC-SA 4.0</a>
                </div>
            
            -->
        </div>
    </div>
    <script>
        function applyNightMode() {
          const isNightMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
          if (isNightMode) {
            document.body.classList.add('night-mode');
          } else {
            document.body.classList.remove('night-mode');
          }
        }
      
        applyNightMode();
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', applyNightMode);
      </script>      
</footer>
</div>
    </div>

        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(r){r.imageLazyLoadSetting.processImages=t;var a=r.imageLazyLoadSetting.isSPA,n=r.imageLazyLoadSetting.preloadRatio||1,d=o();function o(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(t){(a||t)&&(d=o());for(var e,i=0;i<d.length;i++)0<=(e=(e=d[i]).getBoundingClientRect()).bottom&&0<=e.left&&e.top<=(r.innerHeight*n||document.documentElement.clientHeight*n)&&function(){var t,e,a,n,o=d[i];e=function(){d=d.filter(function(t){return o!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(o)},(t=o).dataset.loaded||(t.hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(a=new Image,n=t.getAttribute("data-original"),a.onload=function(){t.src=n,t.removeAttribute("data-original"),t.setAttribute("data-loaded",!0),e&&e()},a.onerror=function(){t.removeAttribute("data-original"),t.setAttribute("data-loaded",!1),t.src=n},t.src!==n&&(a.src=n)))}()}function e(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",e),r.addEventListener("resize",e),r.addEventListener("orientationchange",e)}(this);</script></body>
</html>
